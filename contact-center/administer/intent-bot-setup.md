---
title: Configure intent-based suggestions for Copilot Studio bots
description: This article explains how to configure intent-based suggestions for Copilot Studio bots using Customer intent agent to automate and streamline the process.
author: Soumyasd27
ms.author: sdas
ms.reviewer: Soumyasd27
ms.topic: how-to
ms.collection:
ms.date: 11/27/2024
ms.custom: bap-template
---

# Configure intent-based suggestions for Copilot Studio bot

Customer intent agent discovers historical data and maintains an up-to-date intent library, along with the attributes to support intent determination, interview, and fulfillment, leading to much higher deflection.

Customer intent agent uses the determined intent and interview responses to also improve the quality of generated answers for both Copilot Studio bots and customer service representatives.

You can configure customer intent agent with Copilot Studio bots to provide updated solutions for customer issues.

## Prerequisites

- **Customer Intent Agent (preview)** is enabled.
- Intent discovery is set up and there are intents in the intent library.
- Your Copilot Studio bot must be connected to a workstream in omnichannel.

## Here's how it works

- An administrator sets up intent, harvests historical data to build intent library, and enables the library for Copilot Studio bots and customer service representatives.
- Copilot Studio bot detects intent from the customer, asks follow-up questions related to the intent, and provides a solution based on customer-provided information from the connected Copilot Studio bot knowledge source.
- If the issue is escalated, it's transferred to customer service representatives. The customer intent agent persists intent and interview questions generated by Copilot Studio bots, goes through unanswered questions with customer, and gets an updated solution.
- The application also harvests this conversation to detect any updates, and discovers new intent attributes that can be used in future interviews.
- In the next customer interaction with a Copilot Studio bot, the Copilot Studio bot can self service the customer issue with the newly harvested knowledge and intent, and provide a tailored response without the involvement of any customer service representative.

## Set up Copilot Studio bots for intent management

1.	In Customer Service admin center, navigate to the **Customer Intent Agent (preview)** page > **Intent-based suggestions** section.
1. Select **Enable for chatbots** and then select **Manage**. The **Bots** page appears.
1. Select the chatbot connected to your omnichannel environment for agent transfers.
1. Select **Add intent-based features**. This takes you to **Manage component collections (preview)** in Microsoft Copilot Studio.
1.	In **Manage component collections (preview)**, search and select **Intent-based suggestions**.
1.	Select **Add to agent** and save. 
    You can also disconnect a Copilot Studio bot to stop agent transfers for that Copilot Studio bot by selecting **Remove agent**.
1. Publish the bot. Once added, you'll see a series of Intent-based suggestions topics added to your agent.

## Add connection references

You must add connection references for every new organization when you use it for the first time. Learn more in [Add connection references to a solution](/power-apps/maker/data-platform/create-connection-reference#add-connection-references-to-a-solution).

1. Sign in to [make.powerapps.com](https://make.powerapps.com) and select your environment.
1. Go to **Solutions** > **Default Solution** > **Objects** > **Connection References**.
1. Search for the **IA.Cr.IAPluginDVConnector** connection reference.
1. Create a connection to **Microsoft Dataverse**. 
1. [Publish the bot](/microsoft-copilot-studio/publication-fundamentals-publish-channels?tabs=web).

## End-user authentication

By default, users must be authenticated to access Microsoft Dataverse instance to be able to connect to the intent library and get intent response. 

We recommend you to change to Copilot author authentication from end user authentication to avoid any authentication issues.

1. In Microsoft Copilot Studio, open the **Intent-based suggestions – Plugin** topic. 
1. Select the  ellipsis next to **Connect action** > **Properties**.
1. Select the **End user authentication** dropdown and change it from **User authentication** to **Copilot author authentication**. 

## Update the Intent-based suggestions - Handoff topic

You must have added the required knowledge sources to your Copilot Studio bot. Learn more in [Add knowledge to a Copilot Studio bot](/microsoft-copilot-studio/knowledge-add-existing-copilot).

1. In the **Intent-based suggestions – Handoff** topic, add a node and go to **Advanced** >**Generative answer** and select **SolutionQuery** for Input. 
1. Select **Edit**, enable **Search only selected sources** and then select the relevant knowledge sources that you  added as a prerequisite.
1. Add another node as **Topic management** > **Go to another topic** > **End of Conversation** to add logic to complete the conversation flow after providing an answer.

## Connect to CRM knowledge articles

Connect the knowledge articles in your CRM instance to your Copilot Studio bot. Learn more in [Integrate knowledge management in Dynamics 365 with a Copilot Studio bot](/dynamics365/customer-service/administer/integrate-km-with-pva).

Make sure that that you add the new action you’ve created called **Generate answer from Dataverse knowledge articles for Power Virtual Agent** to the Handoff topic instead of using generative answer. 

## Customize the variables in the Intent-based suggestions - Configuration topic

The Intent-based suggestions - Configuration is a non-customizable topic that contains a list of variables that can be overwritten to provide the desired behavior. Here is a list of variables in the topic. 

|Variable  |Default |Description  |
|---------|---------|---------|
|Global.EnableIntentConfirmation    |    False     |      If enabled, chat bot will ask the customer to confirm the intent before moving on to the intent attributes questions.    |
|Global.EnableIntentRephrase     |   False      |    If enabled, if intent cannot be determined or intent was not confirmed by customer, we will ask customer to rephrase their issue.      |
|Global.RephraseCount     |     1    |   Determines the number of times we ask the customer to rephrase before giving up.       |
|Global.AllowIntentShift      |  False       | If enabled, when intent change is detected, start over and go through confirmation and interview process again for the newly detected intent. If disabled, it will end the loop if we detect a shift in customer intent.         |
|Global.EnableAskAllQuestions     |   False       |    If enabled, ask all intent attribute questions before ending the loop, regardless of whether the customer answers the question in the next turn. If disabled, as soon as the customer doesn’t answer an intent attribute questions, end the loop (a solution query will still be generated and gen answers should still be initiated).      |
|Global.EnableEndUserAuthentication      |    True     |  If enabled, end user (C2) would need to be authenticated and will need access to the underlying Dataverse instance in order to connect to the intent library and get intent response. If disabled, it will fallback to maker authentication to connect to the Dataverse instance. We recommend for most users to override this to false and use maker authentication.        |

### Override default variable

To override any of the variables for the intent-based suggestions:

1. Go to the **Conversation start** topic.
1. Select **Add node (+)** and **Variable management** > **Set a variable value**.
1. Select the variable that you want to change and update the value.
1. Save and publish the bot.

Learn more in [Work with variables](/microsoft-copilot-studio/authoring-variables?tabs=webApp).

### Disable end user authentication

We recommend you to disable end user authentication. To do this, set the **Global.EnableEndUserAuthentication** to **False**.

## Related information

[Create a copilot](/microsoft-copilot-studio/authoring-first-bot?tabs=web#create-a-copilot)
[Add knowledge to a copilot](/microsoft-copilot-studio/knowledge-add-existing-copilot)
[Global variables](/microsoft-copilot-studio/authoring-variables-bot?tabs=webApp)
