---
title: Configure intent-based suggestions for Copilot agents
description: This article explains how to configure intent-based suggestions for Copilot agents using Customer Intent Agent to automate and streamline the process.
author: Soumyasd27
ms.author: sdas
ms.reviewer: Soumyasd27
ms.topic: how-to
ms.collection:
ms.date: 04/04/2025
ms.custom: bap-template
---

# Configure intent-based suggestions for Copilot agents (preview)

[!INCLUDE [preview-banner](~/../shared-content/shared/preview-includes/preview-banner.md)]

Customer Intent Agent discovers intent from historical data and maintains an up-to-date intent library, along with the attributes to support intent determination, interview, and fulfillment, leading to higher deflection rates.

[!INCLUDE [cc-rebrand-bot-agent](../includes/cc-rebrand-bot-agent.md)]

Customer Intent Agent uses the determined intent and interview responses to improve the quality of generated answers for both Copilot agents and customer service representatives (service representatives or representatives).

You can configure Copilot agents with Customer Intent Agent to provide updated solutions for customer issues.

[!INCLUDE [preview-banner](~/../shared-content/shared/preview-includes/preview-note-d365.md)]

## Prerequisites

- [Customer Intent Agent is enabled](manage-customer-intent-agent.md#enable-customer-intent-agent).
- [Intent discovery is set up and there are intents in the intent library](manage-customer-intent-agent.md#manage-intent-discovery-setup).
- Your Copilot agent is connected to knowledge sources and a workstream in omnichannel.
- Makers have the **Environment Maker** role.
- To add connection references, you must have the administrator role.

## Here's how it works

- An administrator sets up intent, uses historical data to build the intent library, and enables the library for Copilot agents and representatives.
- Copilot agent detects intent from the customer, asks follow-up questions related to the intent, and provides a solution based on customer-provided information from the connected Copilot agent knowledge source.
- If the issue is escalated, it's transferred to representatives. The Customer Intent Agent persists the intent and the interview questions generated by the Copilot agents. The service representative goes through unanswered questions with customer, and gets an updated solution.
- The application also uses this conversation to detect any updates and discover new intent attributes that can be used in future interviews.
- In the next customer interaction with a Copilot agent, the Copilot agent can deal with the customer issue with the newly-generated knowledge and intent, and provide a tailored response without escalating to any representative.

## Set up Copilot agents for intent management

1. In Customer Service admin center, navigate to the **Customer Intent Agent (preview)** page > **Intent-based suggestions** section.
1. Select **Enable for chatbots** and then select **Manage**. The **Bots** page appears.
1. Select the agent connected to your omnichannel environment for agent transfers.
1. Select **Add intent-based features** that takes you to **Manage component collections (preview)** in Microsoft Copilot Studio.
1.	In **Manage component collections (preview)**, search for and select **Intent-based suggestions (preview)**.
1.	Select **Add agent**. 
    You can also disconnect a Copilot agent to stop agent transfers for that Copilot agent by selecting **Remove from agent**.
1. Select **Publish**. Once added, you see a series of Intent-based suggestions topics added to your agent.

## Add connection references

Add connection references for each new organization. You only need to create them once, even if you add multiple agents to the organization. Learn more in [Add connection references to a solution](/power-apps/maker/data-platform/create-connection-reference#add-connection-references-to-a-solution).

1. Sign in to [make.powerapps.com](https://make.powerapps.com) and select your environment.
1. Go to **Solutions** > **Default Solution** > **Objects** > **Connection References**.
1. Search for the **IA.Cr.IAPluginDVConnector** connection reference.
1. Create a connection to **Microsoft Dataverse**. 
1. Go to Microsoft Copilot Studio and [publish the agent](/microsoft-copilot-studio/publication-fundamentals-publish-channels?tabs=web).

## User authentication

By default, users must be authenticated to access the Microsoft Dataverse instance to be able to connect to the intent library and get intent response. 

You can switch to Copilot author authentication if users connecting to Copilot Studio don't have access to the Dataverse instance.

1. In Microsoft Copilot Studio, open the **Intent-based suggestions – Plugin** topic. 
1. Select the  ellipsis next to **Connect action** > **Properties**.
1. Select the **End user authentication** dropdown and change it from **User authentication** to **Copilot author authentication**. 

## Connect to intent-based suggestions 

To use Customer Intent Agent, you need to connect your Copilot agent to a knowledge source in Microsoft Copilot Studio. Learn more in [Add knowledge to an agent](/microsoft-copilot-studio/knowledge-add-existing-copilot).

1. In your existing topic flow, where you want to use Customer Intent Agent, add the following node: **Topic management** > **Go to another topic** > **Intent-based suggestions – Main**. For a default agent, we recommend you to add the node to the **Conversational boosting** system topic that triggers the **Unknown** topic.
1. To add the behavior after intent determination and interview completion, select **Add a condition**, and set it to **Global.IntentInterviewComplete is equal to true**,  **Or**,  **Global.IntentInterviewIncomplete is equal to true**.
1. If there isn't an output variable node, add a node under the **Condition** in step 2, and then go to **Advanced** > **Create generative answers** and select **SolutionQuery** for **Input**. Adding a **SolutionQuery** helps generate information from the determined intent and answered questions to search knowledge sources for a solution response.
1. To add logic to complete the conversation flow after providing an answer, add another node: **Topic management** > **Go to another topic** > **End of Conversation**.
1. Under **All other conditions**, add a node for **Topic management** > **Transfer conversation** to ensure that when an intent isn't detected, or if there was an error with intent detection, the conversation is escalated to a support representative.

## Connect to your knowledge base

Connect the knowledge articles in your Dynamics 365 instance to your Copilot agent. Learn more in [Integrate knowledge management in Dynamics 365 with Copilot agents](/dynamics365/customer-service/administer/integrate-km-with-pva).

Make sure that you add the new flow, created in Power Automate called **Generate answer from Dataverse knowledge articles for Power Virtual Agent**, to the **Handoff** topic instead of using generative answer. 

### Intent-based suggestions output variables

This section lists the output variables from Customer Intent Agent that provide information about the status of intent determination and interview. Depending on your use case, you can customize these variables for specific situations.


|Variable  |Scenario |
|---------|---------|
|Global.IntentInterviewComplete    |  If set to true, ensures that the intent is determined and all the interview questions were answered.       |
|Global.IntentInterviewIncomplete    |   If set to true, indicates that the intent is determined but not all interview questions were answered. You can still query knowledge based on the information gathered, but you might choose a different behavior.  |
|Global.IntentUndetected     |    If set to true, indicates that a known intent from the intent library wasn't detected, or was detected but rejected by the customer. |
|Global.IntentShifted     |   If set to true, indicates that the customer's intent shifted but AllowIntentShift is set to false.     |
|Global.IntentError    |     If set to true, indicates that there was an error in detecting intent. The issue could be transitory like a time-out, but if it's consistent, we recommend that you disable intent-based suggestions and contact support. | 


## Variables in the Intent-based suggestions - Configuration topic

The **Intent-based suggestions - Configuration** is a non-customizable topic that contains a list of variables that can be overwritten to provide the desired behavior. Here's a list of variables in the topic. 

|Variable  |Default |Description  |
|---------|---------|---------|
|Global.EnableIntentConfirmation    |    False     |      If enabled, agent asks the customer to confirm the intent before moving on to the intent attributes questions.    |
|Global.EnableIntentRephrase     |   False      |    If enabled, and if intent can't be determined or intent isn't confirmed by customer, customers are asked to rephrase their issue.      |
|Global.RephraseCount     |     1    |   Determines the number of times customers are asked to rephrase before giving up.       |
|Global.AllowIntentShift      |  False       | If enabled, when intent change is detected, the confirmation and interview process starts again for the newly detected intent. If disabled, it ends the loop if a shift in customer intent is detected.         |
|Global.EnableAskAllQuestions     |   False       |    If enabled, asks all intent-attribute questions before ending the loop, regardless of whether the customer answers the question in the next turn. If disabled, as soon as the customer doesn’t answer an intent attribute question, ends the loop (a solution query is still generated and generated answers are still initiated).      |

### Override default variable

To override any of the variables for the intent-based suggestions:

1. Go to the **System**  > **Conversation start** topic.
1. Select **Add node (+)** and **Variable management** > **Set a variable value**.
1. Select the variable that you want to change and update the value.
1. Save and publish the agent.

Learn more in [Work with variables](/microsoft-copilot-studio/authoring-variables?tabs=webApp).

## Updates to Customer Intent Agent

Customer Intent Agents might receive periodic updates, that update the corresponding component collection. To get access and receive these updates, you must manually publish your Copilot agent.

## Related information

[Create a copilot](/microsoft-copilot-studio/authoring-first-bot?tabs=web#create-a-copilot)  
[Add knowledge to a copilot](/microsoft-copilot-studio/knowledge-add-existing-copilot)  
[Global variables](/microsoft-copilot-studio/authoring-variables-bot?tabs=webApp)  
